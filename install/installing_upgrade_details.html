<head><style>

table.confluenceTable { margin:5px; border-collapse:collapse; }
table.confluenceTable td.confluenceTd { border-width:1px; border-style:solid; border-color:#ddd; padding:5px; vertical-align:top; min-width:.6em; }
table.confluenceTable th.confluenceTh,
table.confluenceTable td.highlight { border-width:1px; border-style:solid; border-color:#ddd; padding:5px; background-color:#f0f0f0; text-align:left; vertical-align:top; min-width:.6em; }
ul { list-style-type: square; }

</style></head>

<!-- After change: ee11302-ce18-install-upgrade -->
<!-- title: Upgrading to and Verifying Magento Community Edition and Enterprise Edition - Part 2 -->

<!-- <!DOCTYPE html>
<html lang=en>

<head>
	<meta charset=utf-8>

	<link rel="stylesheet" type="text/css" href="../css/images/stylesheet.css"/>
	<link rel="stylesheet" href="../css/images/stylesheet-fonts.css" type="text/css" charset="utf-8">
	<link rel="icon" href="../css/favicon.ico" type="image/x-icon">
	<link rel="shortcut icon" href="../css/favicon.ico" type="image/x-icon">
	<title>Upgrading to and Verifying Magento Community Edition and Enterprise Edition - Part 2</title>

</head>

<body>
<a name="top"></a>

<h1>Upgrading to and Verifying Magento Community Edition and Enterprise Edition - Part 2</h1>

<img src="../css/images/header.png" width="1024" height="215" alt="header" />

<div id="content">
 -->
 
<h4>Table of Contents</h4> 
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#upgrade-ee-versions">Upgrade Roadmaps</a></li>
<li><a href="#prereq-tasks">Getting Ready For Your Upgrade</a></li>
<!-- <li><a href="#upgrade-mcm">Upgrading to Magento CE 1.8 or EE 1.13 Using Magento Connect Manager</a><li> -->
<li><a href="#upgrade-manual">Upgrading the File System, Solr, and Database</a></li>
<li><a href="#upgrade-manual-post-upgrade-ee11300">Running the URL Redirect Script <em>EE 1.13.0.0 and 1.13.0.1 only</em></a></li>
<li><a href="#upgrade-manual-run">Completing the Magento Upgrade</a></li>
<li><a href="#upgrade-manual-test">Testing the Magento Upgrade</a></li>
<li><a href="#install-privs-after">Setting Magento File System Permissions and Ownership After Upgrade</a></li>
<li><a href="#upgrade-troubleshoot">Troubleshooting</a></li>
</ul>

<h2 id="overview">Overview</h2>
<p>This article discusses how you upgrade to:</p>
<ul><li>Magento Community Edition (CE) 1.8 or 1.9</li>
<li>Magento Enterprise Edition (EE) 1.13.0.2, 1.13.1, or 1.14.0.0</li></ul>
<p class="kb-notes"><strong>Important</strong>: Magento recommends CE 1.9.0.0 or later or EE 1.14.0.0 or later for <em>all CE and EE installations and upgrades</em> to get the latest fixes, features, and security updates.</p>
<p>Because of changes to URL rewrites, the following upgrades are more complex than other upgrades.</p>
<ul><li>Upgrading from EE 1.12 or earlier to EE 1.14.0.0</li>
<li>Upgrading from EE 1.13.0.0 or EE 1.13.0.1 to EE 1.14.0.0</li></ul>
<p class="kb-notes"><strong>Note</strong>: If you're upgrading from EE 1.13.0.2 to EE 1.13.1.0 or later, your upgrade doesn't involve changes to URL rewrites and you can skip many of the steps discussed in the other upgrades. Continue with <a href="#prereq-tasks">Getting Ready For Your Upgrade</a>.</p>

<h2 id="upgrade-ee-versions">Upgrade Roadmaps</h2>
<ul><li>High-level roadmaps for upgrading to EE 1.13.0.2 or later are discussed in <a href="http://www.magentocommerce.com/knowledge-base/entry/ce18-and-ee113-upgrading#ee1300-11301-upgrade-to-ee11302-start" target="_blank">Understanding the Upgrade to EE 1.13.0.2 or EE 1.14</a>.</li>
<li>To upgrade from EE 1.13.0.2 to EE 1.13.1.0 or later (including EE 1.14), see <a href="#prereq-tasks">Getting Ready For Your Upgrade</a>.</li>
<li>To upgrade to CE 1.8 or 1.9, see <a href="http://www.magentocommerce.com/knowledge-base/entry/ce18-upgrade-roadmap" target="_blank">Upgrade Roadmap for CE 1.8 or 1.9</a></li></ul>

<h2 id="prereq-tasks">Getting Ready For Your Upgrade</h2>
<p>This section discusses how to get ready for your upgrade by backing up the database and customizations on the file system. The steps that follow do not affect your current production system. You can continue serving customers with no downtime.</p>
<p>To get ready for your upgrade:</p>
<ol><li>Get the Magento installation archive as discussed in <a href="http://www.magentocommerce.com/knowledge-base/entry/ce18-and-ee113-install-upgrade#get" target="_blank">Getting Magento CE or EE</a>.</li>
<li>Install Magento in a different directory:
<ul><li><em>Recommended</em>. Set up a new system (that is, another host) on which to install Magento.<br />
The system should be identical to, if not better than, your current system. The new system must meet the <a href="http://www.magentocommerce.com/system-requirements" target="_blank">Magento system requirements</a>.</li>
<li>Install Magento in a new, empty root installation directory on the same server.</li>
<p class="kb-notes"><strong>Important</strong>: <em>Do not</em> upgrade Magento in the same directory on the same server because post-upgrade errors are likely to occur.</p></li></ul>
</li>
<li>Magento <em>strongly</em> recommends you observe the following guidelines when you set up the Magento database in your development environment:
<ul>
<li>Magento for the first time uses <a href="http://dev.mysql.com/doc/refman/5.0/en/triggers.html" target="_blank">MySQL database triggers</a> to improve database access during reindexing. Magento does not support any custom triggers in the Magento database because custom triggers can introduce incompatibilities with future Magento versions.</li>
<li>Familiarize yourself with <a href="http://dev.mysql.com/doc/mysql-reslimits-excerpt/5.1/en/stored-program-restrictions.html" target="_blank">these potential MySQL trigger limitations</a> before you continue.</li>
<li>If you use MySQL database replication, Magento <em>does not</em> support MySQL statement-based replication. Make sure you use only <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-formats.html" target="_blank">row-based replication</a>.</li>
<li>Review the MySQL recommendations for <a href="http://dev.mysql.com/doc/refman/5.0/en/password-security-user.html" target="_blank">MySQL password security</a>.</li></ul>
</li>
<li>Complete the tasks discussed in the following sections in the order shown:
<ol><li style="list-style-type:lower-alpha"><a href="#prereq-tasks-prod">Pre-Upgrade Tasks For Your Production Environment</a></li>
<li style="list-style-type:lower-alpha"><a href="#prereq-tasks-dev">Pre-Upgrade Tasks For Your Development Environment</a></li></ol>
</li></ol>

<h3 id="prereq-tasks-prod">Pre-Upgrade Tasks For Your Production Environment</h3>
<p>Complete the tasks discussed in the following sections in the order shown:</p>
<ol><li><a href="#prereq-tasks-prod-logging">Enabling Exception Logging</a></li>
<li><a href="#prereq-tasks-prod-disable-cron-11302">Disabling cron jobs <em>(EE 1.13.0.2 or later)</em></a></li>
<li><a href="#prereq-tasks-prod-index">Setting All Indexers for Update on Save</a></li>
<li><a href="#prereq-tasks-prod-clear-cache">Flushing the Cache</a></li>
<li><a href="#prereq-tasks-prod-backup-db">Backing Up the Database</a></li>
<li><a href="#prereq-tasks-prod-archive">Archiving Customizations and Extensions</a></li>
<li><a href="#prereq-tasks-prod-restore-settings">Restoring Configuration Settings</a></li>
</ol>

<h4 id="prereq-tasks-prod-logging">Enabling Exception Logging</h4>
<p>Before you start your upgrade, you should enable exception logging so it will be enabled on the development system. Without exception logging, it will be more difficult to diagnose errors during your upgrade. You can disable exception logging after you've exported the Magento database.</p>
<p>To enable exception logging:</p>
<ol><li>Log in to the Admin Panel as an administrator.</li>
<li>Click <strong>System</strong> > <strong>Configuration</strong>.</li>
<li>In the ADVANCED group, click <strong>Developer</strong>.<br />
This enables you to enable exception logging so you'll see exceptions in the development environment after the upgrade.</li>
<li>In the right pane, click <strong>Log Settings</strong> to expand it.<br />
The following figure shows an example.<br />
<img src="{filedir_1}upgrade_log.png" height="338px" width="600px"></li>
<li>From the <strong>Enabled</strong> list, click <strong>Yes</strong>.</li>
<li>Optionally change the names of the log files.</li>
<li>Click <strong>Save Config</strong>.</li></ol>

<h4 id="prereq-tasks-prod-disable-cron-11302">Disabling cron Jobs</h4>
<p>Before upgrading to EE 1.13.0.2 or later, disable all running cron jobs. A simple way to stop cron jobs follows; consult an appropriate reference for other options.</p>
<p>As a user with <tt>root</tt> privileges, enter one of the following commands:</p>
<ul><li>Ubuntu: <tt>service crond stop</tt></li>
<li>CentOS: <tt>service cron stop</tt></li></ul>

<!-- <h4 id="prereq-tasks-prod-index111302">Setting All Indexers for Manual Update <em> (EE 1.13.0.2 only)</em></h4>
<p><em>This section applies to Magento EE 1.13.0.2 only</em>. Skip this section if you're using Magento CE.</p>
<p>Because of the changes to indexing in Magento EE 1.13, you must set all indexers to update on save before you upgrade; otherwise, unpredictable performance will result. You can revert indexer settings after you've exported the Magento database.</p>
<p>To set indexers to update on save:</p>
<ol><li>Click <strong>System</strong> > <strong>Index Management</strong>.</li>
<li>On the top left corner of the row, click <strong>Select All</strong> to select all indexers.</li>
<li>From the <strong>Options</strong> list, click <strong>Change indexing mode</strong>.<br />
The <strong>Index Mode</strong> list displays.</li>
<li>From the <strong>Index Mode</strong> list, click <strong>Manual Update</strong>.<br />
The following figure shows an example.<br />
<img src="{filedir_1}upgrade_index-management_manual-update2.png" height="156px" width="600px"></li>
<li>At the top right corner, click <strong>Submit</strong>.</li>
<li>Make sure all indexers are now set for Manual Update as the following figure shows.<br />
<img src="{filedir_1}upgrade_index-management_manual-update.png" height="156px" width="600px"></li></ol> -->

<h4 id="prereq-tasks-prod-index">Setting All Indexers for Update on Save<!--  <em>(EE 1.13.0.0 or 1.13.0.1 only)</em> --></h4>
<p><em>This section applies to upgrading Magento EE only</em>. Skip this section if you're using Magento CE.</p>
<p>Because of the changes to indexing in Magento EE 1.13, you must set all indexers to update on save before you upgrade; otherwise, unpredictable performance will result. You can revert indexer settings after you've exported the Magento database.</p>
<p>To set indexers to update on save:</p>
<ol><li>Click <strong>System</strong> > <strong>Index Management</strong>.</li>
<li>On the top left corner of the row, click <strong>Select All</strong> to select all indexers.</li>
<li>From the <strong>Options</strong> list, click <strong>Change indexing mode</strong>.<br />
The <strong>Index Mode</strong> list displays.</li>
<li>From the <strong>Index Mode</strong> list, click <strong>Update on Save</strong>.<br />
The following figure shows an example.<br />
<img src="{filedir_1}upgrade_index-management.png" height="156px" width="600px"></li>
<li>At the top right corner, click <strong>Submit</strong>.</li>
<li>Make sure all indexers are now set for Update on Save as the following figure shows.<br />
<img src="{filedir_1}upgrade_index-management2.png" height="156px" width="600px"></li></ol>

<h4 id="prereq-tasks-prod-clear-cache">Flushing the Cache</h4>
<p>Clear the Magento cache as follows:</p>
<ol><li>Log in to the Admin Panel as an administrator.</li>
<li>Click <strong>System</strong> > <strong>Cache Management</strong>.</li>
<li>Click <strong>Flush Magento Cache</strong>.</li></ol>

<h4 id="prereq-tasks-prod-backup-db">Backing Up the Database</h4>
<p>Back up your database using <tt>mysqldump</tt> or another tool. <tt>mysqldump</tt> syntax follows:</p>
<code>mysqldump -u root <em>magento-database-name</em> > <em>export-file-name</em>.sql</code>

<h4 id="prereq-tasks-prod-archive">Archiving Customizations and Extensions</h4>
<p>To archive your custom themes and extensions:</p>
<ol><li>Archive the Magento <tt>media</tt> directory and all subdirectories. For example,<br />
<code>cd [your Magento install dir]<br />
tar -czf media.tgz media</code></li>
<li>Archive any custom themes in the following directories:<br />
<pre>[your Magento install dir]/app/design/frontend
[your Magento install dir]/skin/frontend</pre></li>
<li>Archive any customizations or extensions in the following directories:<br />
<pre>[your Magento install dir]/app/code/local
[your Magento install dir]/app/code/community</pre></li>
<li>Transfer the archives you just created to the development environment.</li>
<li>Copy <tt>[your Magento install dir]/app/etc/local.xml</tt> to your development environment.</li>
</ol>

<h4 id="prereq-tasks-prod-restore-settings">Restoring Configuration Settings</h4>
<p>After you've exported the Magento database and extensions, you can revert the configuration changes you made as discussed in these sections:</p>
<ul><li><a href="#prereq-tasks-prod-logging">Enabling Exception Logging</a></li>
<li><a href="#prereq-tasks-prod-index">Setting All Indexers for Update on Save <em>(EE only)</em></a></li></ul>

<h3 id="prereq-tasks-dev">Pre-Upgrade Tasks For Your Development Environment</h3>
<p>In your development environment:</p>
<ol><li>If necessary, create a Magento installation master directory; Magento installs in a <tt>magento</tt> subdirectory of that directory.<br />
The Magento installation archive creates a <tt>magento</tt> subdirectory so if you want your Magento installation directory to be <tt>/var/www/magento</tt>, you don't need to do anything.<br />
<p class="kb-notes"><strong>Tip</strong>: The name and path to the Magento installation directory in your development system does not have to be the same as on your production system, although it might make some tasks simpler.</p></li>
<li>Create a new database instance. For example, you can create a new MySQL database instance named <tt>magento</tt> using the following commands:<br />
<code>mysql -u root -p<br />
#Enter the remaining commands at the mysql> prompt<br />
create database magento;<br />
GRANT USAGE ON *.* TO magento@localhost IDENTIFIED BY 'magento';<br />
GRANT ALL ON magento.* TO magento@localhost;<br />
# For MySQL versions later than 5.0.2 but earlier than 5.1.6, the following command is required:<br />
GRANT SUPER ON *.* TO 'magento'@'localhost';<br />
exit</code><br />
Verify the database exists using the following command:<br />
<code>mysql -u magento -p magento</code><br />
If an error displays, repeat the commands. If the command succeeded, enter <tt>exit</tt> to return to the command prompt.</li>
<li>If you're using <a href="http://selinuxproject.org/page/Main_Page" target="_blank">Security Enhanced Linux (SELinux)</a> <em>and</em> Apache must initiate a connection to another host, you must run the commands discussed in this step.
<ol><li style="list-style-type:lower-alpha">To determine if SELinux is enabled, use the following command:
<code>getenforce</code><br />
<tt>Enforcing</tt> displays to confirm that SELinux is running.</li>
<li style="list-style-type:lower-alpha">Enter one of the following commands:
<code>#CentOS<br />
setsebool -P httpd_can_network_connect=1<br />
<br />
#Ubuntu<br />
setsebool -P apache2_can_network_connect=1<br />
</code></li></ol>
</li></ol>

<h4 id="prereq-tasks-dev-php">Optional: Upgrading to PHP 5.4</h4>
<p>PHP 5.3 is currently the latest PHP version available in the default repositories for Ubuntu and CentOS. PHP 5.3 works with CE 1.8, CE 1.9, EE 1.13, and EE 1.14.</p>
<p>We recommend PHP 5.4 for all of the preceding CE and EE versions because of the <a href="http://php.net/ChangeLog-5.php#5.4.0" target="_blank">new features and changes</a> in that release.</p>
<p>CE 1.8 and EE 1.13 both require a <a href="http://www.magentocommerce.com/knowledge-base/entry/php54-patch" target="_blank">PHP 5.4 patch</a>. The patch is listed as <strong>PHP 5.4 Compatibility</strong> in the EE support portal.</p>

<h5>Upgrading to PHP 5.4&mdash;Ubuntu</h5>
<p>Use the instructions on <a href="http://phpave.com/upgrade-php-5-3-php-5-5-ubuntu-12-04-lts/" target="_blank">phpave</a>.</p>

<h5>Upgrading to PHP 5.4&mdash;CentOS</h5>
<p>Enter the following commands in the order shown as a user with <tt>root</tt> privileges:</p>
<pre>cd /tmp
rpm -Uvh http://download.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm
rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm
yum --enablerepo=remi install httpd php php-common</pre>
<p>The following resources are also available:</p>
<ul><li><a href="http://kb.parallels.com/en/115875" target="_blank">kb.parallels</li>
<li><a href="http://stackoverflow.com/questions/21502656/upgrading-php-on-centos-6-5-final" target="_blank">stackoverflow</a></li>
<li><a href="http://rpms.famillecollet.com/" target="_blank">remi repository</a></li></ul>

<h2 id="upgrade-manual">Upgrading the File System, Solr, and Database</h2>
<p>Upgrade your Magento installation by completing all of the following tasks in the order shown:</p>
<ol><li><a href="#upgrade-manual-prereq">Upgrade Requirements</a></li>
<li><a href="#upgrade-manual-file-sys">Upgrading Assets on the Magento File System</a></li>
<li><a href="#upgrade-manual-db">Upgrading the Magento Database</a></li>
<li><a href="#upgrade-manual-solr">Upgrading Solr (<em>EE 1.14.0.0 only</em>)</a></li>
<li><a href="#upgrade-manual-cleanup">Finishing the File System</a></li></ol>

<h3 id="upgrade-manual-prereq">Upgrade Requirements</h3>
<p>Before attempting your Magento upgrade, complete all the tasks discussed in:</p>
<ul><li><a href="#prereq-tasks">Getting Ready for Your Upgrade</a></li>
<li><a href="http://www.magentocommerce.com/knowledge-base/entry/ce18-and-ee113-install-upgrade#get">Getting Magento CE or EE</a></li></ul>

<h3 id="upgrade-manual-file-sys">Upgrading Assets on the Magento File System</h3>
<p>This section discusses how to extract the Magento archive in your development system and manually copy over your customizations, themes, and extensions.</p>
<p class="kb-notes"><strong>Important</strong>: To avoid errors after upgrading, you <em>must</em> set up a parallel system. <em>Do not</em> upgrade your existing system or post-upgrade errors are likely to occur.</p>
<ol><li>Make sure the CE or EE installation archive is located in the directory above where you want Magento to be installed.<br />
For example, to install Magento to <tt>/var/www/magento</tt>, copy the archive to <tt>/var/www</tt>.</li>
<li>Extract the archive. For example,
<code>tar -zxf <em>archive-name</em></code><br />
This installs Magento CE or EE on the file system on your development system. Next, you'll overwrite some of these assets with customizations from your production system.</li>
<li>Extract the production system's <tt>media</tt> archive, overwriting the installation archive. You created the <tt>media</tt> archive as discussed in <a href="#prereq-tasks">Getting Ready For Your Upgrade</a>.<br />
<p class="kb-notes"><strong>Tip</strong>: Copy the media archive to the same level in the directory structure to simplify the process. For example, if you created the media archive on your production system in your Magento install directory, the archive when extracted creates the <tt>media</tt> directory and all subdirectories. If you copy the media archive to the Magento installation directory on your development system, extracting it automatically replaces existing <tt>media</tt> subdirectory contents.</p></li>
<li>If necessary, move the <tt>media</tt> directory and subdirectories to <tt>media</tt> directory in your new Magento installation, overwriting the existing contents.</li>
<li>Extract the custom theme package archive you created as discussed in <a href="#prereq-tasks">Getting Ready For Your Upgrade</a>.</li>
<li>If necessary, move the theme packages to the <tt>[your Magento install dir]/app/design/frontend</tt> and <tt>[your Magento install dir]/skin/frontend</tt> directories, as appropriate, overwriting the existing contents.</li>
<li>Extract the customization and extension archives you created as discussed in <a href="#prereq-tasks">Getting Ready For Your Upgrade</a>.</li>
<li>If necessary, move the extensions and customizations to the <tt>[your Magento install dir]/app/code/local</tt> and <tt>[your Magento install dir]/app/code/community</tt> directories, as appropriate, overwriting the existing contents.</li></ol>

<h3 id="upgrade-manual-db">Updating the Magento Database</h3>
<p>This section discusses how to:</p>
<ul><li>Import the production database data into the development database instance.</li>
<li>In the development database instance, change the values of the paths <tt>web/unsecure/base_url</tt> and <tt>web/secure/base_url</tt> in the <tt>core_config_data</tt> table to the development server's IP address or host name.</li></ul>
<p>Import the production database data using your database manager tool.</p>
<p class="kb-notes"><strong>Important</strong>: The database instance into which you import <em>must be empty</em>.</p>
<p><tt>mysql</tt> syntax follows:</p>
<code>mysql -u root -p <em>database-name</em> &lt; <em>database-export-filename</em>.sql</code>
For example, if the database name is <tt>magento</tt> and the database export file name is <tt>mangento-db-export.sql</tt>, enter
<code>mysql -u root -p magento &lt; mangento-db-export.sql</code></li>
<p>The following sections discuss how to change the base URL paths from <tt>http://prod.example.com</tt> to <tt>http://dev.example.com</tt> using SQL commands and phpmyadmin:</p>
<ul><li><a href="#upgrade-manual-db-sql">Updating the Base URL the Database Using SQL Commands</a></li>
<li><a href="#upgrade-manual-db-phpmyadmin">Updating the Base URL the Database Using phpmyadmin</a></li></ul>

<h4 id="upgrade-manual-db-sql">Updating the Base URL the Database Using SQL Commands</h4>
<p>This section discusses how to update the secure and unsecure URLs of your webstores and store views in the Magento database. The following example assumes you have two URLs, which every Magento installation has by default. Depending on your setup, you could have more (for additional store views, Content Delivery Networks (CDNs) and so on.</p>
<p>Use the following procedure to update <em>all</em> matching URLs in the database.</p>
<p>To update the database with the development system's base URLs using SQL commands:</p>
<ol><li>Log in to the database server as any user.</li>
<li>Enter the following commands in the order shown:
<code>mysql -u root -p <br />
#Enter the remaining commands at the mysql> prompt.<br />
<br />
use <em>magento-db-name</em>;<br />
SELECT * FROM core_config_data WHERE path LIKE '%base_url%';</code></li>
<li>In the resulting output, make note of the rows that include <tt>web/unsecure/base_url</tt> and <tt>web/secure/base_url</tt>.<br />
In particular, you must know the value of the <tt>config_id</tt> for these rows.</li>
<li>Carefully examine the <em>entire URL</em> to avoid mistakes.</li>
<li>Enter the following command to update the values of <tt>web/unsecure/base_url</tt> and <tt>web/secure/base_url</tt>:
<code>UPDATE core_config_data SET value='<em>base-url</em>' WHERE config_id=<em>id1</em> or config_id=<em>id2</em>;<br />
<br />
#Example 1 - config_ids are the same: if your base URL is http://dev.example.com/, the config_id of the row containing web/unsecure/base_url is 354 <br />
#and the config_id of the row containing web/secure/base_url is 355, enter:<br />
<br />
UPDATE core_config_data SET value='http://dev.example.com/' WHERE config_id=354 or config_id=355;<br />
<br />
#Example 2 - config_ids are different: Same as preceding example except that  web/secure/base_url uses https://<br />
UPDATE core_config_data SET value='http://dev.example.com/' WHERE config_id=354;<br />
UPDATE core_config_data SET value='https://dev.example.com/' WHERE config_id=355;</code></li>
<li>Verify the values are set correctly.
<code>SELECT * FROM core_config_data WHERE path LIKE '%base_url%';</code></li>
<li>For other URLs, be careful to perform the replacement correctly.<br />
For example, store view base link URLs resemble the following:<br />
<code>http://prod.example.com/view1/</code><br />
Make sure to update the URL like the following:<br />
<code>UPDATE core_config_data SET value='http://dev.example.com/view1/' WHERE config_id=377;</code></li>
<li>When you're done, run the following command again:<br />
<code>SELECT * FROM core_config_data WHERE path LIKE '%base_url%';</code></li>
<li>If the values are set correctly, enter <tt>exit</tt> at the <tt>mysql></tt> prompt and continue with <a href="#upgrade-manual-cleanup">Finishing the File System</a>.<br />
If not, repeat the tasks discussed in this section. <em>Do not continue</em> until the database is updated.</li>
</ol>

<h4 id="upgrade-manual-db-phpmyadmin">Updating the Base URL the Database Using phpmyadmin</h4>
<p>This section discusses how to use phpmyadmin to change the values of the paths <tt>web/unsecure/base_url</tt> and <tt>web/secure/base_url</tt> in the <tt>core_config_data</tt> table to the development server's IP address or host name.</p>
<ol><li>In a web browser's location or address field, enter <tt><em>dev-web-server-host-or-ip</em>/phpmyadmin</tt>
For example, if your web server address is <tt>http://dev.example.com</tt>, enter
<code>http://dev.example.com/phpmyadmin</code></li>
<li>Log in as the MySQL <tt>root</tt> user.</li>
<li>In the left navigation bar, click the name of your Magento database.</li>
<li>In the left navigation bar, click the <strong>core_config_data</strong> table.</li>
<li>At the top of the page, click the <strong>Search</strong> tab.</li>
<li>In the Search tab page, from the <strong>Operator</strong> list, click <strong>LIKE</strong>.</li>
<li>Enter <tt>%base_url%</tt> in the <strong>Value</strong> field.<br />
The following figure shows an example.<br />
<img src="{filedir_1}install_myphpadmin_search.png" height="279px" width="600px"></li>
<li>Click <strong>Go</strong>.<br />
The following figure shows sample results.<br />
<img src="{filedir_1}install_myphpadmin_results.png" height="139px" width="600px"></li>
<li>Click <img src="{filedir_1}install_myphpadmin_edit-icon.png"> (Edit) in the row that includes the path <tt>web/unsecure/base_url</tt>.</li>
<li>Change the value to the host name or IP address of your development server.<br />
The following figure shows an example.<br />
<img src="{filedir_1}install_myphpadmin_edit.png" height="333px" width="600px">
<li>Click <strong>Go</strong>.</li>
<li>Repeat these tasks for the path that includes <tt>web/secure/base_url</tt>.</li>
<li>Exit phpmyadmin.</li></ol>
</li></ol> 

<h3 id="upgrade-manual-solr">Upgrading Solr (EE 1.14.0.0 only)</h3>
<p><em>This section applies to upgrading to EE 1.14.0.0 using the Solr search engine only</em>. If you're upgrading to a different version&mdash;or if you're not using Solr&mdash;skip this section and continue with <a href="#upgrade-manual-cleanup">Finishing the File System</a>.</p>
<p>Because of changes to the Solr schema, you must copy two files from Magento to your Solr installation. Failure to do so might prevent products from displaying on your web store. After copying the files, you must also reindex the catalog search index.</p>
<p>To update Solr:</p>
<ol><li>If the Solr search engine is running, stop it.</li>
<li>Copy the following files from the Magento 1.14.0.0 installation to the equivalent directory on your Solr installation:
<pre>[your Magento install dir]/lib/Apache/Solr/conf/schema.xml
[your Magento install dir]/lib/Apache/Solr/conf/solrconfig.xml</pre>
<p>For example, if Magento is installed in <tt>/var/www/html/magento</tt> and the example Solr configuration is installed in the <tt>/etc/solr/apache-solr-3.6.2/example/solr/conf</tt> directory on the same host, enter:</p>
<pre>cp /var/www/html/magento/lib/Apache/Solr/conf/solrconfig.xml /etc/solr/apache-solr-3.6.2/example/solr/conf
cp /var/www/html/magento/lib/Apache/Solr/conf/schema.xml /etc/solr/apache-solr-3.6.2/example/solr/conf</pre></li>
<li>Restart Solr.</li>
<li>After you copy the files, you must update the catalog search index. To update the catalog search index, open a command prompt window.</li>
<li>Change to the <tt>shell</tt> subdirectory of your Magento installation directory.<br />
For example, on CentOS:
<pre>cd /var/www/html/magento/shell</pre></li>
<li>Enter the following command:
<pre>php indexer.php --reindex catalogsearch_fulltext</tt></li></ol>
<p class="kb-notes"><strong>Note</strong>: The preceding example showed paths used by the Solr example configuration. Solr ships with a sample configuration that Magento suggests you use for development only. Do not use the Solr example configuration in production.</p>

<h3 id="upgrade-manual-cleanup">Finishing the File System</h3>
<p>This section discusses how to edit copy <tt>local.xml</tt> and set file system permissions and ownership on the production system.</p>

<h4 id="upgrade-manual-cleanup-localxml">Copying local.xml</h4>
<ol><li>Copy your production system's <tt>local.xml</tt> to <tt>[your Magento install dir]/app/etc</tt>.</li>
<li>Open <tt>local.xml</tt> in a text editor.</li>
<li>If necessary, change the database connection information in the <tt>default_setup</tt> element, as follows:
<code>&lt;default_setup><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;connection><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;host>&lt;![CDATA[<em>change-if-necessary</em>]]>&lt;/host><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;username>&lt;![CDATA[<em>change-if-necessary</em>]]>&lt;/username><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;password>&lt;![CDATA[<em>change-if-necessary</em>]]>&lt;/password><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dbname>&lt;![CDATA[<em>change-if-necessary</em>]]>&lt;/dbname><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;initStatements>&lt;![CDATA[SET NAMES utf8]]>&lt;/initStatements><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;model>&lt;![CDATA[mysql4]]>&lt;/model><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;type>&lt;![CDATA[pdo_mysql]]>&lt;/type><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pdoType>&lt;![CDATA[]]>&lt;/pdoType><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;active>1&lt;/active><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/connection><br />
&lt;/default_setup></code></li>
<li>Save your changes to <tt>local.xml</tt> and exit the text editor.</li></ol>

<h4 id="upgrade-manual-cleanup-perms">Setting File and Directory Ownership and Privileges</h4>
<p>Magento recommends the following ownership and privilege settings for files and directories in the Magento installation directory:</p>
<ul>
<ul><li>The Magento installation directory and all subdirectories are owned by the web server user.<br />
This enables the web server to change files in these subdirectories but other users cannot access them (except a higher-level user such as <tt>root</tt>).</li>
<li>All directories have 700 permissions (<tt>drwx------</tt>).<br />
700 permissions give full control (that is, read/write/execute) to the owner and no permissions to anyone else.</li>
<li>All files have 600 permissions (<tt>-rw-------</tt>).<br />
600 permissions mean the owner can read and write but other users have no permissions.</li></ul>
<p><strong>Note</strong>: The way you set permissions and ownership depends on whether Magento is running on a dedicated or hosted system:</p>
<ul><li><em>Hosted</em>: A Magento server located on a hosting provider. A <em>hosted</em> system typically does not enable you to elevate to <tt>root</tt>. The web server typically runs as an ordinary user. Magento assumes you log in as this user to start and stop the web server and that you already own all the files and directories in the Magento installation directory. You can use <tt>chmod</tt> to change permissions on files and directories.</li>
<li><em>Dedicated</em>: A Magento server you control and operate. Unlike a hosted system, you can elevate to <tt>root</tt> and, as <tt>root</tt>, you can use the <tt>chown</tt> and <tt>chmod</tt> commands to set ownership and privileges in the Magento installation directory.</li></ul>
<p>To set privileges and ownership:</p>
<ol><li>Log in to your Magento server.</li>
<li>Change to your Magento installation directory:
<pre>#Ubuntu example
cd /var/www/magento

#CentOS example
cd /var/www/html/magento</pre></li>
<li><em>Dedicated Magento server only</em>. Enter the following command to set ownership of the Magento installation directory and all its subdirectories:
<pre>chown -R <em>web-server-user-name</em> .</pre>
For example, on Ubuntu where Apache usually runs as <tt>www-data</tt>, enter
<pre>chown -R www-data .</pre></li>
<li>Enter the following commands to set directory permissions to 700 and file permissions to 600:
<pre>find . -type d -exec chmod 700 {} \;
find . -type f -exec chmod 600 {} \;</pre></li></ol>

<li>Set file permissions on the Magento installation directory and subdirectories as follows.<br />
<!-- Start by changing to your Magento installation directory:
<code>#Ubuntu example<br />
cd /var/www/magento<br />
<br />
#CentOS example<br />
cd /var/www/html/magento</code></li>
<li>Set file permissions.
<code>find . -type f -exec chmod 644 {} \;</code></li>
<li>Set directory permissions.
<code>find . -type d -exec chmod 755 {} \;</code></li>
<li>Make the <tt>var</tt>, <tt>app/etc</tt>, and <tt>media</tt> directories and subdirectories world-writable.
<code>chmod -R 777 media app/etc var var/.htaccess</code></li>
<li>Change to the directory above the Magento install directory.
<code>#Ubuntu example<br />
cd /var/www<br />
<br />
#CentOS example<br />
cd /var/www/html</code></li>
<li>Set ownership.
<code>#If you're not sure, find the web server group<br />
ps -o "user group command" -C httpd,apache2<br />
<br />
#Set ownership<br />
chown -R <em>your-user-name</em>:<em>web-server-group</em> magento<br />
<br />
#Ubuntu example<br />
chown -R myuser:www-data magento</code></li></ol> -->

<h2 id="upgrade-manual-post-upgrade-ee11300">Running the URL Redirect Script (EE 1.13.0.0 and 1.13.0.1 only)</h2>
<p>If you're upgrading to EE 1.14 from EE 1.13.0.0 or 1.13.0.1, see <a href="http://www.magentocommerce.com/knowledge-base/entry/ee-11300-or-ee-11301-url-redirect-script" target="_blank">EE 1.13.1.0 Upgrade: Running the EE 1.13.0.0 or EE 1.13.0.1 URL Redirect Script</a> now. When you're done, return here to continue your upgrade.</p>

<h2 id="upgrade-manual-run">Completing the Magento Upgrade</h2>
<p>To complete the upgrade, go to your Magento base URL in a web browser. The first time you go to your Magento base URL, server-side scripts run to update the database. Depending on the amount of data in your database, this process can take a long time.</p>
<p><p class="kb-notes"><strong>Important</strong>: <em>Completing the upgrade requires downtime on your production system</em>. If you continue to take orders on your production system, there is no way to reconcile all of the new orders in the replacement development system. You can reduce the amount of downtime to a minimum by thoroughly testing your development system before shutting down production.</p>
<p>If you're upgrading from a version earlier than CE 1.4 or EE 1.7, Magento <em>strongly recommends</em> the two-step upgrade approach discussed in <a href="http://www.magentocommerce.com/knowledge-base/entry/ce18-and-ee113-upgrading#upgrade-path">Upgrade Path</a>. In addition, you should expect the upgrade and testing process to take a long time and to expect more downtime for your production system.</p></p>
<p>Complete the following tasks in the order shown:</p>
<ol><li><a href="#upgrade-manual-scripts">Running the Upgrade Scripts and Fixing Exceptions</a></li>
<li><a href="#upgrade-manual-post-upgrade-11302">Running the URL Redirect Script <em>(EE 1.12.x and earlier only)</em></a></li>
<li><a href="#upgrade-manual-post-upgrade-11300">Post-Upgrade Tasks <em>(EE 1.13.0.1 Only)</em></a></li> 
<li><a href="#upgrade-manual-cron">Setting Up the Magento Cron Job</a></li>
<li><a href="#upgrade-manual-var">Clearing Magento var/ Subdirectories</a></li>
<li><a href="#upgrade-manual-index">Verifying the Status of Indexers</a></li>
<li><a href="#upgrade-manual-test">Testing the Magento Upgrade</a></li>
<li><a href="#upgrade-downtime">Taking Your Old Production System Offline</a></li></ol>

<h3 id="upgrade-manual-scripts">Running the Upgrade Scripts and Fixing Exceptions</h3>
<p>The first step in your upgrade is to run server-side upgrade scripts. Depending on the nature of your customizations and extensions, and how many customers and products are in your database, these scripts can take a long time to run and can result in exceptions. You must resolve all exceptions before continuing to the next step in the process.</p>
<p>This step in the upgrade process is iterative; that is, you'll probably run through it more than once.</p>
<p class="kb-notes"><strong>Note</strong>: Your production system remains up during this step in the upgrade process. You can continue taking and shipping orders and also making changes in the Admin Panel.</p>
<p>To run the upgrade scripts:</p>
<ol><li>In a web browser address or location field, enter your Magento installation's base URL.<br />
<p class="kb-notes"><strong>Note</strong>: If you upgraded Magento on the same server, you might need to update your Apache web server's virtual host configuration to reference the new Magento installation directory. For more information about configuring virtual hosts, see the <a href="http://httpd.apache.org/docs/2.2/vhosts" target="_blank">Apache Virtual Host documentation</a>.</p>
(You updated the Magento database with the development system base URL as discussed in <a href="#upgrade-manual-db">Updating the Magento Database</a>.)</li>
<li>Wait while upgrade scripts run on the server.</li>
<li>If fatal errors or exceptions display in the browser, they are most likely related to customizations. To resolve fatal errors, you must:
<ol><li style="list-style-type:lower-alpha">Analyze the errors to determine the root cause.<br />
You can find errors in the web server's error log or in <tt>[your Magento install dir]/var/log</tt>.</li>
<li style="list-style-type:lower-alpha">Fix the cause in your extension code.</li>
<li style="list-style-type:lower-alpha">In your development environment, drop the Magento database.</li>
<li style="list-style-type:lower-alpha">Re-create the development database and import production data into it as discussed in <A href="#upgrade-manual-db">Updating the Magento Database</a>.</li>
<li style="list-style-type:lower-alpha">Use the following command to delete the contents of the Magento <tt>var/</tt> subdirectories:
<code>rm -rf [your Magento install dir]/var/cache [your Magento install dir]/var/full_page_cache [your Magento install dir]/var/locks [your Magento install dir]/var/session</code><br />
<p class="kb-notes"><strong>Note</strong>: Some of these directories might be empty; this is normal.</p>
</li>
<li style="list-style-type:lower-alpha">Clean up the file system as discussed in <a href="#upgrade-manual-cleanup">Finishing the File System</a>.</li>
<li style="list-style-type:lower-alpha">Repeat step 1 in this section.</li>
<li style="list-style-type:lower-alpha">Repeat the tasks discussed in this section until no more fatal errors display in the browser.</li></ol>
</li></ol>

<h3 id="upgrade-manual-post-upgrade-11300">Post-Upgrade Tasks (EE 1.13.0.1 Only)</h3>
<p><em>This section applies to upgrading from 1.13.0.1 only.</em> If you're upgrading CE or if you're upgrading from a different EE version, continue with <a href="#upgrade-manual-cron">Setting Up the Magento Cron Job</a>.</p>
<p>After successfully running the Magento upgrade and fixing errors, enter the following command from the Magento root directory:</p>
<code>php -f shell/indexer.php -- --reindexall</code>
<p>This command runs a full reindex and it might take a long time, depending on the size of your database.</p>
<p>After the reindex completes, enter the following command from your Magento installation directory:</p>
<code>rm -rf var/cache var/full_page_cache var/locks</code>
<p>Continue with <a href="#upgrade-manual-cron">Setting Up Magento Cron Jobs</a>.</p>

<h3 id="upgrade-manual-post-upgrade-11302">Running the URL Redirect Script (EE 1.12.x and Earlier Only)</h3>
<p>If you're upgrading to EE 1.14 from EE 1.12 or earlier, see <a href="http://www.magentocommerce.com/knowledge-base/entry/ee-112-and-earlier-url-redirect-script" target="_blank">EE 1.14 Upgrade: Running the EE 1.12 and Earlier URL Redirect Script</a> now. When you're done, return here to continue your upgrade.</p>
<!-- <h3 id="upgrade-manual-post-upgrade-ee112">Running a Full Reindex <em>(EE 1.13.0.0 or 1.13.0.1 only)</em></h3>
<p>If you're upgrading from EE 1.13.0.0 or 1.13.0.1, enter the following commands as a user with <codE>root</code> privileges to fully reindex:</p>
<ol><li>Change to the Magento installation directory.</li>
<li>Enter the following command:<br />
<code>php -f shell/indexer.php -- --reindexall</code></li>
<li>Wait while Magento reindexes; if you have a large database, reindexing can take a long time.</li>
<li>Clear the Magento <tt>var/</tt> subdirectories as discussed in the next section.</li></ol> -->

<h3 id="upgrade-manual-cron">Setting Up the Magento Cron Job</h3>
<p>You should now set up your Magento cron job as discussed <a href="http://www.magentocommerce.com/knowledge-base/entry/ce18-and-ee113-installing#install-cron" target=_"blank">here</a>.</p>

<h3 id="upgrade-manual-var">Clearing Magento var/ Subdirectories</h3>
<p>Run the following command to clean the Magento <tt>var/</tt> subdirectories:</p>
<pre>rm -rf [your Magento install dir]/var/cache [your Magento install dir]/var/full_page_cache [your Magento install dir]/var/locks</pre>
<p class="kb-notes"><strong>Note</strong>: Some of these directories might be empty; this is normal.</p>

<h3 id="upgrade-manual-index">Verifying the Status of Indexers</h3>
<p>After the cron job runs, all indexers should be in a Ready status. Before testing your upgrade, verify all indexers are Ready; otherwise, your testing will be inconclusive.</p>
<p>To verify the status of indexers:</p>
<ol><li>Log in to the Admin Panel as an administrator.</li> 
<li>Click <strong>System</strong> > <strong>Index Management</strong>.<br />
Verify that all indexers have a status of Ready, as the following figure shows.<br />
<img src="{filedir_1}upgrade_index-management_after.png" width="600px" height="154px"/></li>
<li>If indexers are <em>not</em> Ready, use the following guidelines:
<table class="confluenceTable">
<tbody>
<tr>
  <th class="confluenceTh">Indexer status</th>
  <th class="confluenceTh">Suggested action</th>
</tr>
<tr>
  <td class="confluenceTd">Scheduled</td>
  <td class="confluenceTd">Wait for cron to finish or run <tt>http://<em>magento-host-name</em>/cron.php</tt> from a web browser.</td>
</tr>
<tr>
  <td class="confluenceTd">Processing</td>
  <td class="confluenceTd"><p>Wait for cron to finish or run <tt>cron.php</tt> from a web browser. (For example, <tt>http://www.example.com/magento/cron.php</tt>)</p>
  <p>If indexers are Processing for an extended period of time, run the command discussed in <a href="#upgrade-manual-var">Clearing Magento var/ Subdirectories</a> and refresh the Index Management page.</p></td>
</tbody>
</table></li></ol>

<h3 id="upgrade-manual-test">Testing the Magento Upgrade</h3>
<p>After you have upgraded with no fatal errors or exceptions, Magento strongly recommends you thoroughly test the upgrade in your development environment as follows:</p>
<ol><li>Test all extensions and customizations thoroughly.<br />
Make sure the UIs perform as expected, make sure the extensions behave properly, and so on.</li>
<li>Run some orders, making sure prices are calculated correctly and that orders go through the configured payment mechanisms.</li>
<li>If you encounter issues, <a href="http://www.magentocommerce.com/knowledge-base/entry/ce18-and-ee113-install-upgrade#help" target="_blank">get help</a>.</li>
<li>Before making the development system live, back up everything in your production and development environments again.<br />
The way you make your development system live is up to you; a simple way is to update your DNS server to point to the development IP address.</li></ol>

<h3 id="upgrade-downtime">Taking Your Old Production System Offline</h3>
<p>The last step in upgrading is to take your production system offline and switching to your development system&mdash;which then becomes the production system from that point on.</p>
<p><p class="kb-notes"><strong>Important</strong>: Before continuing, make sure all errors have been resolved and that you have thoroughly tested the upgrade as discussed in the preceding section.</p>
<p>To switch from your production to development system:</p>
<ol><li>Put your production system in maintenance mode so it cannot accept orders or other changes.<br />
To do so, create an empty file named <tt>[your Magento install dir]/maintenance.flag</tt>.</li>
<li>Test it by going to your Magento web store's front page.<br />
The following message displays if you set up maintenance mode correctly:
<code>The server is temporarily unable to service your request due to maintenance downtime or capacity problems. Please try again later.</code></li>
<li>If necessary, update the development database again to get any final transactions processed by your current production system.<br />
For details, see <a href="#upgrade-manual-db">Updating the Magento Database</a>.</li>
<li>Put your production system in maintenance mode so it cannot process orders.</li>
<li>Make your development system live.<br />
The way you do this is up to you; typically, you can configure your DNS server to send requests for your web store domain to the development system's IP address. Be aware that propagating the change to other DNS servers can take some time.</li>
<li>Verify your former development system is functioning as your new Magento web store in production.</li>
<li>Shut down the old production system.</li></ol>
<p>Congratulations! You successfully upgraded! Review our <a href="http://www.magentocommerce.com/knowledge-base/entry/ce-19-and-ee-114-documentation-home">welcome page</a> to see the improvements you're getting.</p>

<h2 id="install-privs-after">Setting Magento File System Permissions and Ownership After Upgrade</h2>
<p>To secure your Magento installation after the upgrade, see <a href="http://www.magentocommerce.com/knowledge-base/entry/install-privs-after" target="_blank">After You Install Magento: Recommended File System Ownership and Privileges</a>.</p>

<h2 id="upgrade-troubleshoot">Troubleshooting</h2>
<p>There is a known issue after upgrading to EE 1.13.1 that affects you <em>only</em> if you do <em>not</em> follow the recommended procedure to upgrade to a new environment as discussed in <a href="#prereq-tasks">Getting Ready For Your Upgrade</a>.</p>
<p><strong>Symptom</strong>: After completing the upgrade, when you log in to the Admin Panel and click <strong>System</strong> > <strong>Configuration</strong>, a fatal error similar to the following displays in your browser:</p>
<pre>Class 'Mage_Googlecheckout_Helper_Data' not found in /var/www/html/magento/app/Mage.php on line 547</pre>
<!-- <p><strong>Description</strong>: TBD -->
<p><strong>Solution</strong>:</p>
<ol><li>Close the Admin Panel browser window.</li>
<li>As a user with <tt>root</tt> privileges, delete all files <em>except</em> <tt>config.xml</tt> from the following directory:<br />
<pre>[your Magento install dir]/app/code/core/Mage/GoogleCheckout/etc</pre></li>
<li>When you log back in to the Admin Panel, everything works as expected.</li></ol>

<p>In the event of any other issue during the upgrade, see <a href="http://www.magentocommerce.com/knowledge-base/entry/ce18-and-ee113-install-upgrade#help" target="_blank">Getting Help With Your Installation or Upgrade</a>.</p>
 
</p>
